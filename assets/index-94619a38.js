var Kt=Object.defineProperty;var zt=(t,e,n)=>e in t?Kt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ee=(t,e,n)=>(zt(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(r){if(r.ep)return;r.ep=!0;const l=n(r);fetch(r.href,l)}})();function M(){}function mt(t){return t()}function je(){return Object.create(null)}function z(t){t.forEach(mt)}function qt(t){return typeof t=="function"}function A(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Bt(t){return Object.keys(t).length===0}function yt(t,...e){if(t==null)return M;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function be(t){let e;return yt(t,n=>e=n)(),e}function O(t,e,n){t.$$.on_destroy.push(yt(e,n))}function Je(t){return t??""}function b(t,e){t.appendChild(e)}function I(t,e,n){t.insertBefore(e,n||null)}function T(t){t.parentNode&&t.parentNode.removeChild(t)}function xe(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function V(t){return document.createElement(t)}function B(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function pe(t){return document.createTextNode(t)}function G(){return pe(" ")}function ke(){return pe("")}function C(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function wt(t){return function(e){return e.preventDefault(),t.call(this,e)}}function a(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function $t(t){return t===""?null:+t}function At(t){return Array.from(t.childNodes)}function vt(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function Ze(t,e){t.value=e??""}function L(t,e,n,s){n===null?t.style.removeProperty(e):t.style.setProperty(e,n,s?"important":"")}function et(t,e,n){for(let s=0;s<t.options.length;s+=1){const r=t.options[s];if(r.__value===e){r.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function Dt(t){const e=t.querySelector(":checked");return e&&e.__value}function Lt(t,e,{bubbles:n=!1,cancelable:s=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,s,e),r}let Pe;function we(t){Pe=t}function ze(){if(!Pe)throw new Error("Function called outside component initialization");return Pe}function Qt(t){ze().$$.before_update.push(t)}function Be(t){ze().$$.on_mount.push(t)}function bt(t){ze().$$.on_destroy.push(t)}function Yt(){const t=ze();return(e,n,{cancelable:s=!1}={})=>{const r=t.$$.callbacks[e];if(r){const l=Lt(e,n,{cancelable:s});return r.slice().forEach(o=>{o.call(t,l)}),!l.defaultPrevented}return!0}}function Xt(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(s=>s.call(this,e))}const ue=[],he=[];let fe=[];const tt=[],xt=Promise.resolve();let Qe=!1;function Ut(){Qe||(Qe=!0,xt.then(kt))}function Oe(t){fe.push(t)}const Ae=new Set;let ie=0;function kt(){if(ie!==0)return;const t=Pe;do{try{for(;ie<ue.length;){const e=ue[ie];ie++,we(e),Gt(e.$$)}}catch(e){throw ue.length=0,ie=0,e}for(we(null),ue.length=0,ie=0;he.length;)he.pop()();for(let e=0;e<fe.length;e+=1){const n=fe[e];Ae.has(n)||(Ae.add(n),n())}fe.length=0}while(ue.length);for(;tt.length;)tt.pop()();Qe=!1,Ae.clear(),we(t)}function Gt(t){if(t.fragment!==null){t.update(),z(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Oe)}}function Ht(t){const e=[],n=[];fe.forEach(s=>t.indexOf(s)===-1?e.push(s):n.push(s)),n.forEach(s=>s()),fe=e}const We=new Set;let ne;function Me(){ne={r:0,c:[],p:ne}}function Ie(){ne.r||z(ne.c),ne=ne.p}function P(t,e){t&&t.i&&(We.delete(t),t.i(e))}function N(t,e,n,s){if(t&&t.o){if(We.has(t))return;We.add(t),ne.c.push(()=>{We.delete(t),s&&(n&&t.d(1),s())}),t.o(e)}else s&&s()}function Ft(t,e){N(t,1,1,()=>{e.delete(t.key)})}function jt(t,e,n,s,r,l,o,i,u,c,f,w){let p=t.length,d=l.length,y=p;const _={};for(;y--;)_[t[y].key]=y;const v=[],m=new Map,q=new Map,h=[];for(y=d;y--;){const S=w(r,l,y),E=n(S);let R=o.get(E);R?s&&h.push(()=>R.p(S,e)):(R=c(E,S),R.c()),m.set(E,v[y]=R),E in _&&q.set(E,Math.abs(y-_[E]))}const W=new Set,F=new Set;function Z(S){P(S,1),S.m(i,f),o.set(S.key,S),f=S.first,d--}for(;p&&d;){const S=v[d-1],E=t[p-1],R=S.key,j=E.key;S===E?(f=S.first,p--,d--):m.has(j)?!o.has(R)||W.has(R)?Z(S):F.has(j)?p--:q.get(R)>q.get(j)?(F.add(R),Z(S)):(W.add(j),p--):(u(E,o),p--)}for(;p--;){const S=t[p];m.has(S.key)||u(S,o)}for(;d;)Z(v[d-1]);return z(h),v}function H(t){t&&t.c()}function Q(t,e,n,s){const{fragment:r,after_update:l}=t.$$;r&&r.m(e,n),s||Oe(()=>{const o=t.$$.on_mount.map(mt).filter(qt);t.$$.on_destroy?t.$$.on_destroy.push(...o):z(o),t.$$.on_mount=[]}),l.forEach(Oe)}function Y(t,e){const n=t.$$;n.fragment!==null&&(Ht(n.after_update),z(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Jt(t,e){t.$$.dirty[0]===-1&&(ue.push(t),Ut(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function x(t,e,n,s,r,l,o,i=[-1]){const u=Pe;we(t);const c=t.$$={fragment:null,ctx:[],props:l,update:M,not_equal:r,bound:je(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:je(),dirty:i,skip_bound:!1,root:e.target||u.$$.root};o&&o(c.root);let f=!1;if(c.ctx=n?n(t,e.props||{},(w,p,...d)=>{const y=d.length?d[0]:p;return c.ctx&&r(c.ctx[w],c.ctx[w]=y)&&(!c.skip_bound&&c.bound[w]&&c.bound[w](y),f&&Jt(t,w)),p}):[],c.update(),f=!0,z(c.before_update),c.fragment=s?s(c.ctx):!1,e.target){if(e.hydrate){const w=At(e.target);c.fragment&&c.fragment.l(w),w.forEach(T)}else c.fragment&&c.fragment.c();e.intro&&P(t.$$.fragment),Q(t,e.target,e.anchor,e.customElement),kt()}we(u)}class U{$destroy(){Y(this,1),this.$destroy=M}$on(e,n){if(!qt(n))return M;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(n),()=>{const r=s.indexOf(n);r!==-1&&s.splice(r,1)}}$set(e){this.$$set&&!Bt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const le=[];function re(t,e=M){let n;const s=new Set;function r(i){if(A(t,i)&&(t=i,n)){const u=!le.length;for(const c of s)c[1](),le.push(c,t);if(u){for(let c=0;c<le.length;c+=2)le[c][0](le[c+1]);le.length=0}}}function l(i){r(i(t))}function o(i,u=M){const c=[i,u];return s.add(c),s.size===1&&(n=e(r)||M),i(t),()=>{s.delete(c),s.size===0&&n&&(n(),n=null)}}return{set:r,update:l,subscribe:o}}class Zt{constructor(){ee(this,"sqrValues");ee(this,"isTurnToWhite");ee(this,"enPassant",{isPossible:!1,columnNumber:-1});ee(this,"castling",{blackKing:!0,blackQueen:!0,whiteKing:!0,whiteQueen:!0});ee(this,"tripleRep");ee(this,"fiftyMove")}}const ve=0,se=1,Te=2,Ve=3,de=4,$=5,Ce=6,Ue=8,Se=16;function Pt(t){let e=qe(t);return[t-e,e,e===Se]}function qe(t){return t?t>Se?Se:Ue:ve}function ce(t){return t?Se:Ue}function J(t){return t<0||t>63}let Tt=0,St=0;document.onmousemove=t=>{Tt=t.pageX,St=t.pageY};function ae(){let t=Math.floor((Tt-Xe[0])/be(X)),e=Math.floor((St-Xe[1])/be(X)),n=e*8+t;return e>7||e<0||t>7||t<0?-1:n}function Mt(t){let e=[];for(let n=0;n<64;n++)e.push({id:n,value:t[n]});return e}let ye=[];function en(t){ye=structuredClone(t)}const De=[8,-8,1,-1,7,-7,9,-9],nt=[16-1,16+1,2+8,2-8,-16+1,-16-1,-2-8,-2+8],st=[Ce,Ve,$,de],rt=[2,6,58,62];let Ye=[],K=[],Ge=re(null);function Ee(t,e,n=!0){e===void 0&&(e=D);const s=e.sqrValues[t.startSqr]-ce(e.isTurnToWhite);r(),o(),i(),u(),c(),n&&(ge.set(Mt(e.sqrValues)),Ge.set(t)),l(),Wt(n,e);function r(){e.fiftyMove++,(s===Te||e.sqrValues[t.targetSqr])&&(e.fiftyMove=0)}function l(){s===Te?e.tripleRep=[]:e.tripleRep.push(structuredClone(e.sqrValues))}function o(){e.enPassant.isPossible=!1,t.hasDoublePawnMove&&(e.enPassant={isPossible:!0,columnNumber:K[t.targetSqr][0]})}function i(){e.sqrValues[t.targetSqr]=t.promotion?t.promotion:e.sqrValues[t.startSqr],e.sqrValues[t.startSqr]=ve,t.enPassantTargetSqr!==void 0&&(e.sqrValues[t.enPassantTargetSqr]=ve)}function u(){t.castle&&(e.sqrValues[t.targetSqr-t.castle.increment]=$+ce(e.isTurnToWhite),e.sqrValues[t.castle.rookIndex]===$+ce(e.isTurnToWhite)&&(e.sqrValues[t.castle.rookIndex]=ve))}function c(){if(t.castle||s===se)e.isTurnToWhite?(e.castling.whiteKing=!1,e.castling.whiteQueen=!1):(e.castling.blackKing=!1,e.castling.blackQueen=!1);else if(s===$){const f=e.sqrValues.findIndex(w=>w===se+ce(e.isTurnToWhite));t.startSqr<f?e.isTurnToWhite?e.castling.whiteQueen=!1:e.castling.blackQueen=!1:e.isTurnToWhite?e.castling.whiteKing=!1:e.castling.blackKing=!1}}}function tn(){Ye=[];for(let t=0;t<8;t++)for(let e=0;e<8;e++){let n=7-t,s=t,r=7-e,l=e;Ye.push([n,s,r,l,Math.min(n,l),Math.min(s,r),Math.min(n,r),Math.min(s,l)])}}function nn(){K=[];for(let t=0;t<64;t++){let e=t%8,n=Math.floor(t/8);K.push([e,n])}}function It(t){if(t.fiftyMove>99)return[{state:"end",reason:"50move"},[]];if(l())return[{state:"end",reason:"tripleRep"},[]];let e=Le(t);const n=t.sqrValues.findIndex(o=>o===se+ce(t.isTurnToWhite));for(let o=0;o<e.length;o++){let i=function(w){let p=Le(f);r(w,p)&&(e.splice(o,1),o--)};const u=e[o];let c=n,f=structuredClone(t);if(Ee(u,f,!1),f.sqrValues[u.targetSqr]===se+ce(t.isTurnToWhite)&&(c=u.targetSqr),u.castle){let w=Math.abs(u.targetSqr-u.startSqr);for(let p=0;p<=w;p++){const d=u.startSqr+u.castle.increment*p;i(d)}}else i(c)}if(e.length>0)return[{state:"play",reason:"none"},e];let s=structuredClone(t);if(s.isTurnToWhite=!s.isTurnToWhite,r(n,Le(s)))return[{state:"end",reason:"checkmate"},[]];return[{state:"end",reason:"stalemate"},[]];function r(o,i){return i.some(u=>u.targetSqr===o)}function l(){let o=0;const i=t.tripleRep[t.tripleRep.length-1];for(let u=t.tripleRep.length-3;u>=0;u-=2){const c=t.tripleRep[u];if(i.every((f,w)=>f===c[w])&&o++,o>1)return!0}return!1}}function Le(t){let e=[];const n=t;for(let s=0;s<n.sqrValues.length;s++){let r=function(){let[p,d]=K[s];for(let m=0;m<De.length;m++){const q=s+De[m];if(J(q))continue;let[h,W]=K[q];if(Math.abs(p-h)>1||Math.abs(d-W)>1)continue;const F=n.sqrValues[q];qe(F)!==f&&e.push({startSqr:s,targetSqr:q})}const y=w?n.castling.whiteKing:n.castling.blackKing,_=w?n.castling.whiteQueen:n.castling.blackQueen;if(y){let m=n.sqrValues.findIndex((q,h)=>q-f===$&&h>s);if(m>-1&&v(1,m-s)){const q=(f/8-1)*2+1;e.push({startSqr:s,targetSqr:rt[q],castle:{increment:1,rookIndex:m}})}}if(_){let m=n.sqrValues.findIndex((q,h)=>q-f===$&&h<s);if(m>-1&&v(-1,s-m)){const q=(f/8-1)*2;e.push({startSqr:s,targetSqr:rt[q],castle:{increment:-1,rookIndex:m}})}}function v(m,q){for(let h=1;h<q;h++){const W=s+h*m;if(n.sqrValues[W])return!1}return!0}},l=function(){const p=n.isTurnToWhite?-8:8,d=s+p;let y=n.sqrValues[d];if(!y){if(m(6))v(d);else if(e.push({startSqr:s,targetSqr:d}),m(1)){const q=s+p*2;y=n.sqrValues[q],y||e.push({startSqr:s,targetSqr:q,hasDoublePawnMove:!0})}}const _=[s+p+1,s+p-1];for(let q=0;q<_.length;q++){const h=_[q],W=n.sqrValues[h];if(J(h))continue;const[F,Z]=K[s],[S,E]=K[h],R=Math.abs(S-F)<2,j=Math.abs(E-Z)<2;if(R&&j){if(W)qe(W)!==f&&(m(6)?v(h):e.push({startSqr:s,targetSqr:h}));else if(n.enPassant.isPossible&&m(4)){let _e=h-p;n.enPassant.columnNumber===K[_e][0]&&e.push({startSqr:s,targetSqr:h,enPassantTargetSqr:_e})}}}function v(q){for(let h=0;h<st.length;h++)e.push({startSqr:s,targetSqr:q,promotion:st[h]+f})}function m(q){const h=K[s][1];return n.isTurnToWhite?h===7-q:h===q}},o=function(){const[p,d]=K[s];for(let y=0;y<nt.length;y++){const _=s+nt[y];if(J(_))continue;const v=n.sqrValues[_];if(qe(v)===f)continue;const[m,q]=K[_],h=Math.abs(m-p)<3,W=Math.abs(q-d)<3;h&&W&&e.push({startSqr:s,targetSqr:_})}},i=function(){const p=c===de?4:0,d=c===$?4:8;for(let y=p;y<d;y++)for(let _=0;_<Ye[s][y];_++){const v=s+De[y]*(_+1),m=n.sqrValues[v];if(qe(m)===f||(e.push({startSqr:s,targetSqr:v}),m))break}};const u=n.sqrValues[s],[c,f,w]=Pt(u);!c||w!==n.isTurnToWhite||(c===de||c===Ce||c===$?i():c===Ve?o():c===Te?l():c===se&&r())}return e}function sn(t){let e=It(t)[1];return e[rn(0,e.length)]}function rn(t,e){return Math.floor(Math.random()*(e-t)+t)}const on={evaluatePosition:sn};function ln(t){return on.evaluatePosition(t)}const un={playMove:ln},cn="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";let oe=re([]),ge=re([]),te=re([]),X=re(0),Vt=re({state:"play",reason:"none"}),Ct=re(200),Xe=[0,0],fn={k:se,p:Te,n:Ve,b:de,r:$,q:Ce},D,Re="pvp";function an(t){Re=t}let Ke;function pn(t,e){Nt(t,e),He()}function He(t,e){D=new Zt,D.enPassant={isPossible:!1,columnNumber:-1},D.tripleRep=[],D.fiftyMove=0,gn(t||cn,D),e!==void 0&&(Ke=e),Ge.set(null),tn(),nn(),Wt(!0,D),ge.set(Mt(D.sqrValues))}function Nt(t,e){Xe=[e[0]+window.scrollX,e[1]+window.scrollY],X.set(t/8),dn(e)}function Wt(t=!0,e){if(e.isTurnToWhite=!e.isTurnToWhite,t){let[n,s]=It(e);hn(n,s),Re!=="pvp"&&(Re==="cvc"||e.isTurnToWhite!==Ke)&&setTimeout(()=>{let r=un.playMove(e);r&&Ee(r)},be(Ct))}}function hn(t,e){Vt.set(t),en(e)}function dn(t){let e=[];for(let n=0;n<8;n++)for(let s=0;s<8;s++){let r=[t[0]+s*be(X)+window.scrollX,t[1]+n*be(X)+window.scrollY];e.push(r)}oe.set(e)}function gn(t,e){e.sqrValues=new Array(64).fill(ve);let n=t.split(" ")[0],s=t.split(" ")[1]!=="w";e.isTurnToWhite=s;let r=t.split(" ")[2];e.castling.blackKing=r.includes("k"),e.castling.blackQueen=r.includes("q"),e.castling.whiteKing=r.includes("K"),e.castling.whiteQueen=r.includes("Q");let l=0,o=0;for(let i=0;i<n.length;i++){const u=n[i];if(u==="/"){o++,l=0;continue}if(Number(u)){l+=Number(u);continue}let c=u.toUpperCase()===u,f=fn[u.toLowerCase()]+(c?Se:Ue);e.sqrValues[o*8+l]=f,l++}}function ot(t,e,n){const s=t.slice();return s[16]=e[n],s[18]=n,s}function it(t){let e,n,s;function r(){return t[6](t[18])}return{c(){e=V("div"),a(e,"class","promotion-piece svelte-o42z3p"),L(e,"background-image","url(/chess_pieces/"+t[0]+t[16]+".svg)")},m(l,o){I(l,e,o),n||(s=C(e,"mousedown",r),n=!0)},p(l,o){t=l,o&3&&L(e,"background-image","url(/chess_pieces/"+t[0]+t[16]+".svg)")},d(l){l&&T(e),n=!1,s()}}}function _n(t){let e,n,s,r=t[1],l=[];for(let o=0;o<r.length;o+=1)l[o]=it(ot(t,r,o));return{c(){e=V("div");for(let o=0;o<l.length;o+=1)l[o].c();a(e,"id","promotion-panel"),a(e,"class","svelte-o42z3p")},m(o,i){I(o,e,i);for(let u=0;u<l.length;u+=1)l[u]&&l[u].m(e,null);t[9](e),n||(s=[C(e,"mouseleave",t[7]),C(e,"mouseenter",t[8])],n=!0)},p(o,[i]){if(i&19){r=o[1];let u;for(u=0;u<r.length;u+=1){const c=ot(o,r,u);l[u]?l[u].p(c,i):(l[u]=it(c),l[u].c(),l[u].m(e,null))}for(;u<l.length;u+=1)l[u].d(1);l.length=r.length}},i:M,o:M,d(o){o&&T(e),xe(l,o),t[9](null),n=!1,z(s)}}}function mn(t,e,n){let s,r;O(t,X,h=>n(12,s=h)),O(t,oe,h=>n(13,r=h));let{color:l}=e,{positionIndex:o}=e,i,u=["q","n","r","b"],c=[Ce,Ve,$,de],f;const w=Yt();let p=!0;Be(()=>{let h=o,W=o;i=l==="w",i||(c=c.reverse(),n(1,u=u.reverse()),W-=24),n(2,f.style.left=`${r[h][0]}px`,f),n(2,f.style.top=`${r[W][1]}px`,f),n(2,f.style.width=`${s}px`,f),n(2,f.style.height=`${s*4}px`,f)}),bt(()=>{window.removeEventListener("mousedown",d)}),window.addEventListener("mousedown",d);function d(){p||w("canceled")}function y(h){w("promoted",{pieceType:c[h]})}const _=h=>y(h),v=()=>n(3,p=!1),m=()=>n(3,p=!0);function q(h){he[h?"unshift":"push"](()=>{f=h,n(2,f)})}return t.$$set=h=>{"color"in h&&n(0,l=h.color),"positionIndex"in h&&n(5,o=h.positionIndex)},[l,u,f,p,y,o,_,v,m,q]}class qn extends U{constructor(e){super(),x(this,e,mn,_n,A,{color:0,positionIndex:5})}}function lt(t){let e,n;return e=new qn({props:{color:t[1],positionIndex:t[2].positionIndex}}),e.$on("promoted",t[7]),e.$on("canceled",t[8]),{c(){H(e.$$.fragment)},m(s,r){Q(e,s,r),n=!0},p(s,r){const l={};r&2&&(l.color=s[1]),r&4&&(l.positionIndex=s[2].positionIndex),e.$set(l)},i(s){n||(P(e.$$.fragment,s),n=!0)},o(s){N(e.$$.fragment,s),n=!1},d(s){Y(e,s)}}}function yn(t){let e,n,s,r,l,o,i=t[2].isPromoting&&lt(t);return{c(){e=V("div"),n=G(),i&&i.c(),s=ke(),a(e,"class","piece svelte-17lpnvq")},m(u,c){I(u,e,c),t[12](e),I(u,n,c),i&&i.m(u,c),I(u,s,c),r=!0,l||(o=[C(window,"wheel",t[4]),C(window,"mouseup",t[5]),C(window,"mousemove",t[4]),C(window,"mousedown",t[6]),C(e,"mouseup",t[3])],l=!0)},p(u,[c]){u[2].isPromoting?i?(i.p(u,c),c&4&&P(i,1)):(i=lt(u),i.c(),P(i,1),i.m(s.parentNode,s)):i&&(Me(),N(i,1,1,()=>{i=null}),Ie())},i(u){r||(P(i),r=!0)},o(u){N(i),r=!1},d(u){u&&T(e),t[12](null),u&&T(n),i&&i.d(u),u&&T(s),l=!1,z(o)}}}function wn(t,e,n){let s,r,l;O(t,X,g=>n(10,s=g)),O(t,oe,g=>n(11,r=g)),O(t,ge,g=>n(20,l=g));let{myIndex:o}=e,i,u,c=!1,f="w",w,p,d,y,_=0,v={isPromoting:!1,positionIndex:0,moves:[null]},m={[se]:"k",[Te]:"p",[Ve]:"n",[de]:"b",[$]:"r",[Ce]:"q"};Be(()=>{c=!0,F(),h()});let q=ge.subscribe(()=>{c&&h()});bt(()=>q());function h(){let[g,k,me]=Pt(l[o].value);w=k,p=me,n(1,f=p?"w":"b");let Ne=m[g];u=f+Ne,Ne&&(W(s),$e(o),n(0,i.style.backgroundImage=`url(./chess_pieces/${u}.svg)`,i))}function W(g){i&&(n(0,i.style.width=`${g}px`,i),n(0,i.style.height=`${g}px`,i))}function F(){n(0,i.style.position="absolute",i),n(0,i.style.cursor="grab",i),n(0,i.style.userSelect="none",i)}function Z(g){d=!0,y=!0,_++,Fe(g),n(0,i.style.cursor="grabbing",i),n(0,i.style.zIndex="10",i),te.set(ye.filter(k=>k.startSqr===o))}function S(){if(ae()===o&&_>1){y=!1,_=0,te.set([]);return}}function E(g){d&&Fe(g)}function R(){if(n(0,i.style.zIndex="0",i),!d)return;d=!1,n(0,i.style.cursor="grab",i);let g=ae();_e({startSqr:o,targetSqr:g})}function j(g){if(g.button!==0){y=!1,_=0,te.set([]);return}let k=ae();if(k===o){Z(g);return}if(!y||p!==D.isTurnToWhite)return;y=!1,_=0,(J(k)||!l[k].value)&&te.set([]),_e({startSqr:o,targetSqr:k})}function _e(g){if(ye.some(k=>k.startSqr===g.startSqr&&k.targetSqr===g.targetSqr)){if(g=ye.find(k=>k.startSqr===g.startSqr&&k.targetSqr===g.targetSqr),g.promotion){te.set([]),n(2,v={isPromoting:!0,positionIndex:g.targetSqr,moves:ye.filter(k=>k.startSqr===g.startSqr&&k.targetSqr===g.targetSqr)}),n(9,o=g.targetSqr);return}te.set([]),Ee(g),n(9,o=g.targetSqr);return}$e(o)}function $e(g,k=r){i&&(n(9,o=g),n(0,i.style.left=`${k[g][0]}px`,i),n(0,i.style.top=`${k[g][1]}px`,i))}function Ot(g){n(2,v.isPromoting=!1,v);const k=g.detail.pieceType+w;let me=v.moves.find(Ne=>Ne.promotion===k);Ee(me),n(9,o=me.targetSqr)}function Et(){n(2,v.isPromoting=!1,v),n(9,o=v.moves[0].startSqr)}function Fe(g){n(0,i.style.left=`${g.pageX-s/2}px`,i),n(0,i.style.top=`${g.pageY-s/2}px`,i)}function Rt(g){he[g?"unshift":"push"](()=>{i=g,n(0,i)})}return t.$$set=g=>{"myIndex"in g&&n(9,o=g.myIndex)},t.$$.update=()=>{t.$$.dirty&2560&&$e(o,r),t.$$.dirty&1024&&W(s)},[i,f,v,S,E,R,j,Ot,Et,o,s,r,Rt]}class vn extends U{constructor(e){super(),x(this,e,wn,yn,A,{myIndex:9})}}function ut(t,e,n){const s=t.slice();return s[1]=e[n],s[3]=n,s}function ct(t){let e,n;return e=new vn({props:{myIndex:t[3]}}),{c(){H(e.$$.fragment)},m(s,r){Q(e,s,r),n=!0},p(s,r){const l={};r&1&&(l.myIndex=s[3]),e.$set(l)},i(s){n||(P(e.$$.fragment,s),n=!0)},o(s){N(e.$$.fragment,s),n=!1},d(s){Y(e,s)}}}function ft(t,e){let n,s,r,l=e[1].value&&ct(e);return{key:t,first:null,c(){n=ke(),l&&l.c(),s=ke(),this.first=n},m(o,i){I(o,n,i),l&&l.m(o,i),I(o,s,i),r=!0},p(o,i){e=o,e[1].value?l?(l.p(e,i),i&1&&P(l,1)):(l=ct(e),l.c(),P(l,1),l.m(s.parentNode,s)):l&&(Me(),N(l,1,1,()=>{l=null}),Ie())},i(o){r||(P(l),r=!0)},o(o){N(l),r=!1},d(o){o&&T(n),l&&l.d(o),o&&T(s)}}}function bn(t){let e,n=[],s=new Map,r,l=t[0];const o=i=>i[1].id;for(let i=0;i<l.length;i+=1){let u=ut(t,l,i),c=o(u);s.set(c,n[i]=ft(c,u))}return{c(){e=V("div");for(let i=0;i<n.length;i+=1)n[i].c();a(e,"id","pieces")},m(i,u){I(i,e,u);for(let c=0;c<n.length;c+=1)n[c]&&n[c].m(e,null);r=!0},p(i,[u]){u&1&&(l=i[0],Me(),n=jt(n,u,o,1,i,l,s,e,Ft,ft,null,ut),Ie())},i(i){if(!r){for(let u=0;u<l.length;u+=1)P(n[u]);r=!0}},o(i){for(let u=0;u<n.length;u+=1)N(n[u]);r=!1},d(i){i&&T(e);for(let u=0;u<n.length;u+=1)n[u].d()}}}function kn(t,e,n){let s;return O(t,ge,r=>n(0,s=r)),[s]}class Pn extends U{constructor(e){super(),x(this,e,kn,bn,A,{})}}function Tn(t){let e,n,s,r;return{c(){e=V("div"),a(e,"class",n="square "+(t[2]+t[3])+" svelte-1f0bc4l")},m(l,o){I(l,e,o),t[9](e),s||(r=[C(window,"contextmenu",t[4]),C(window,"mousedown",t[8])],s=!0)},p(l,[o]){o&12&&n!==(n="square "+(l[2]+l[3])+" svelte-1f0bc4l")&&a(e,"class",n)},i:M,o:M,d(l){l&&T(e),t[9](null),s=!1,z(r)}}}function Sn(t,e,n){let s,r,l,o;O(t,X,_=>n(10,r=_)),O(t,oe,_=>n(6,l=_)),O(t,Ge,_=>n(7,o=_));let{index:i}=e,u,c,f=!1;Be(()=>{n(2,c=(i+Math.floor(i/8))%2!==0?"dark":"light"),w(l)});function w(_){u&&(n(1,u.style.left=`${_[i][0]}px`,u),n(1,u.style.top=`${_[i][1]}px`,u),n(1,u.style.width=`${r}px`,u),n(1,u.style.height=`${r}px`,u))}function p(){ae()===i&&n(0,f=!f)}const d=_=>{_.button===0&&n(0,f=!1)};function y(_){he[_?"unshift":"push"](()=>{u=_,n(1,u)})}return t.$$set=_=>{"index"in _&&n(5,i=_.index)},t.$$.update=()=>{t.$$.dirty&64&&w(l),t.$$.dirty&161&&n(3,s=f?"highlight":o&&(i===o.startSqr||i===o.targetSqr)?"move":"")},[f,u,c,s,p,i,l,o,d,y]}class Mn extends U{constructor(e){super(),x(this,e,Sn,Tn,A,{index:5})}}function at(t,e,n){const s=t.slice();return s[1]=e[n],s[3]=n,s}function pt(t){let e,n;return e=new Mn({props:{index:t[3]}}),{c(){H(e.$$.fragment)},m(s,r){Q(e,s,r),n=!0},p:M,i(s){n||(P(e.$$.fragment,s),n=!0)},o(s){N(e.$$.fragment,s),n=!1},d(s){Y(e,s)}}}function In(t){let e,n,s=t[0],r=[];for(let o=0;o<s.length;o+=1)r[o]=pt(at(t,s,o));const l=o=>N(r[o],1,1,()=>{r[o]=null});return{c(){e=V("div");for(let o=0;o<r.length;o+=1)r[o].c();a(e,"id","squares")},m(o,i){I(o,e,i);for(let u=0;u<r.length;u+=1)r[u]&&r[u].m(e,null);n=!0},p(o,[i]){if(i&1){s=o[0];let u;for(u=0;u<s.length;u+=1){const c=at(o,s,u);r[u]?(r[u].p(c,i),P(r[u],1)):(r[u]=pt(c),r[u].c(),P(r[u],1),r[u].m(e,null))}for(Me(),u=s.length;u<r.length;u+=1)l(u);Ie()}},i(o){if(!n){for(let i=0;i<s.length;i+=1)P(r[i]);n=!0}},o(o){r=r.filter(Boolean);for(let i=0;i<r.length;i+=1)N(r[i]);n=!1},d(o){o&&T(e),xe(r,o)}}}function Vn(t,e,n){let s;return O(t,oe,r=>n(0,s=r)),[s]}class Cn extends U{constructor(e){super(),x(this,e,Vn,In,A,{})}}function ht(t){let e,n,s,r,l,o,i,u;return{c(){e=B("svg"),n=B("mask"),s=B("rect"),r=B("rect"),i=B("rect"),a(s,"height","100%"),a(s,"width","100%"),a(s,"fill","white"),a(r,"x",l=(t[1]-t[4])/2),a(r,"y",o=(t[1]-t[4])/2),a(r,"height",t[4]),a(r,"width",t[4]),a(r,"fill","black"),a(n,"id","sqrmask"),a(i,"height","100%"),a(i,"width","100%"),a(i,"mask","url(#sqrmask)"),a(i,"class",u=Je(t[3])+" svelte-hvbtlg"),a(e,"id","hoverSqr"),L(e,"left",t[5][t[0]][0]),L(e,"top",t[5][t[0]][1]),a(e,"width",t[1]),a(e,"height",t[1]),a(e,"class","svelte-hvbtlg")},m(c,f){I(c,e,f),b(e,n),b(n,s),b(n,r),b(e,i)},p(c,f){f&18&&l!==(l=(c[1]-c[4])/2)&&a(r,"x",l),f&18&&o!==(o=(c[1]-c[4])/2)&&a(r,"y",o),f&16&&a(r,"height",c[4]),f&16&&a(r,"width",c[4]),f&8&&u!==(u=Je(c[3])+" svelte-hvbtlg")&&a(i,"class",u),f&33&&L(e,"left",c[5][c[0]][0]),f&33&&L(e,"top",c[5][c[0]][1]),f&2&&a(e,"width",c[1]),f&2&&a(e,"height",c[1])},d(c){c&&T(e)}}}function Nn(t){let e=t[2]&&!J(t[0]),n,s,r,l=e&&ht(t);return{c(){l&&l.c(),n=ke()},m(o,i){l&&l.m(o,i),I(o,n,i),s||(r=[C(window,"mousemove",t[7]),C(window,"mousedown",t[6]),C(window,"mouseup",t[8])],s=!0)},p(o,[i]){i&5&&(e=o[2]&&!J(o[0])),e?l?l.p(o,i):(l=ht(o),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null)},i:M,o:M,d(o){l&&l.d(o),o&&T(n),s=!1,z(r)}}}function Wn(t,e,n){let s,r,l,o,i;O(t,ge,d=>n(9,l=d)),O(t,X,d=>n(1,o=d)),O(t,oe,d=>n(5,i=d));let u=!1,c=ae();function f(){J(c)||l[c].value&&n(2,u=!0)}const w=()=>n(0,c=ae()),p=()=>n(2,u=!1);return t.$$.update=()=>{t.$$.dirty&2&&n(4,s=o/1.15),t.$$.dirty&1&&n(3,r=J(c)||(K[c][0]+K[c][1])%2!==0?"dark":"light")},[c,o,u,r,s,i,f,w,p]}class On extends U{constructor(e){super(),x(this,e,Wn,Nn,A,{})}}function dt(t,e,n){const s=t.slice();return s[3]=e[n],s}function En(t){let e,n;return{c(){e=B("circle"),a(e,"cx","50%"),a(e,"cy","50%"),a(e,"r",n=t[2]/6)},m(s,r){I(s,e,r)},p(s,r){r&4&&n!==(n=s[2]/6)&&a(e,"r",n)},d(s){s&&T(e)}}}function Rn(t){let e,n,s,r,l,o;return{c(){e=B("mask"),n=B("circle"),r=B("circle"),o=B("circle"),a(n,"cx","50%"),a(n,"cy","50%"),a(n,"r",s=t[2]/2),a(n,"fill","white"),a(r,"cx","50%"),a(r,"cy","50%"),a(r,"r",l=t[2]/2.5),a(r,"fill","black"),a(e,"id","maskoption"),a(e,"width",t[2]),a(e,"height",t[2]),a(o,"cx","50%"),a(o,"cy","50%"),a(o,"r","50%"),a(o,"mask","url(#maskoption)")},m(i,u){I(i,e,u),b(e,n),b(e,r),I(i,o,u)},p(i,u){u&4&&s!==(s=i[2]/2)&&a(n,"r",s),u&4&&l!==(l=i[2]/2.5)&&a(r,"r",l),u&4&&a(e,"width",i[2]),u&4&&a(e,"height",i[2])},d(i){i&&T(e),i&&T(o)}}}function gt(t){let e,n=t[3].targetSqr+"",s;function r(i,u){return D.sqrValues[i[3].targetSqr]?Rn:En}let l=r(t),o=l(t);return{c(){e=B("svg"),s=pe(n),o.c(),a(e,"class","option svelte-1dn02r2"),L(e,"left",t[1][t[3].targetSqr][0]),L(e,"top",t[1][t[3].targetSqr][1]),a(e,"width",t[2]),a(e,"height",t[2])},m(i,u){I(i,e,u),b(e,s),o.m(e,null)},p(i,u){u&1&&n!==(n=i[3].targetSqr+"")&&vt(s,n),l===(l=r(i))&&o?o.p(i,u):(o.d(1),o=l(i),o&&(o.c(),o.m(e,null))),u&3&&L(e,"left",i[1][i[3].targetSqr][0]),u&3&&L(e,"top",i[1][i[3].targetSqr][1]),u&4&&a(e,"width",i[2]),u&4&&a(e,"height",i[2])},d(i){i&&T(e),o.d()}}}function Kn(t){let e,n=t[0],s=[];for(let r=0;r<n.length;r+=1)s[r]=gt(dt(t,n,r));return{c(){for(let r=0;r<s.length;r+=1)s[r].c();e=ke()},m(r,l){for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(r,l);I(r,e,l)},p(r,[l]){if(l&7){n=r[0];let o;for(o=0;o<n.length;o+=1){const i=dt(r,n,o);s[o]?s[o].p(i,l):(s[o]=gt(i),s[o].c(),s[o].m(e.parentNode,e))}for(;o<s.length;o+=1)s[o].d(1);s.length=n.length}},i:M,o:M,d(r){xe(s,r),r&&T(e)}}}function zn(t,e,n){let s,r,l;return O(t,te,o=>n(0,s=o)),O(t,oe,o=>n(1,r=o)),O(t,X,o=>n(2,l=o)),[s,r,l]}class Bn extends U{constructor(e){super(),x(this,e,zn,Kn,A,{})}}function $n(t){let e,n,s,r,l,o,i,u,c;return n=new Cn({}),r=new Pn({}),o=new Bn({}),u=new On({}),{c(){e=V("div"),H(n.$$.fragment),s=G(),H(r.$$.fragment),l=G(),H(o.$$.fragment),i=G(),H(u.$$.fragment),a(e,"id","board"),a(e,"class","svelte-z3otcb")},m(f,w){I(f,e,w),Q(n,e,null),b(e,s),Q(r,e,null),b(e,l),Q(o,e,null),b(e,i),Q(u,e,null),t[1](e),c=!0},p:M,i(f){c||(P(n.$$.fragment,f),P(r.$$.fragment,f),P(o.$$.fragment,f),P(u.$$.fragment,f),c=!0)},o(f){N(n.$$.fragment,f),N(r.$$.fragment,f),N(o.$$.fragment,f),N(u.$$.fragment,f),c=!1},d(f){f&&T(e),Y(n),Y(r),Y(o),Y(u),t[1](null)}}}function An(t,e,n){let s=!1,r,l=new ResizeObserver(()=>{Nt(r.getBoundingClientRect().width,o())}),o=()=>{let u=r.getBoundingClientRect().left,c=r.getBoundingClientRect().top;return[u,c]};Be(()=>{l.observe(r)}),Qt(()=>{s||(pn(800,[0,0]),s=!0)});function i(u){he[u?"unshift":"push"](()=>{r=u,n(0,r)})}return[r,i]}class Dn extends U{constructor(e){super(),x(this,e,An,$n,A,{})}}function _t(t){let e,n,s;return{c(){e=V("input"),a(e,"type","range"),a(e,"name","cpu-move-speed"),a(e,"id","cpu-move-speed"),a(e,"min","0"),a(e,"max","2000")},m(r,l){I(r,e,l),Ze(e,t[0]),n||(s=[C(e,"change",t[6]),C(e,"input",t[6])],n=!0)},p(r,l){l&1&&Ze(e,r[0])},d(r){r&&T(e),n=!1,z(s)}}}function Ln(t){let e,n,s,r,l,o,i,u,c,f,w,p,d,y,_,v,m=t[1]==="cvc"&&_t(t);return{c(){e=V("form"),n=V("label"),n.textContent="Game mode",s=G(),r=V("select"),l=V("option"),l.textContent="Player vs Player",o=V("option"),o.textContent="Player vs Computer",i=V("option"),i.textContent="Computer vs Computer",u=G(),c=V("label"),f=V("input"),w=pe("Play as white"),p=G(),d=V("button"),d.textContent="Play",y=G(),m&&m.c(),a(n,"for","game-mode"),a(n,"class","svelte-f2deec"),l.__value="pvp",l.value=l.__value,l.selected=!0,a(l,"class","svelte-f2deec"),o.__value="pvc",o.value=o.__value,a(o,"class","svelte-f2deec"),i.__value="cvc",i.value=i.__value,a(i,"class","svelte-f2deec"),a(r,"name","selection"),a(r,"id","game-mode"),a(r,"class","svelte-f2deec"),t[1]===void 0&&Oe(()=>t[4].call(r)),a(f,"type","checkbox"),a(f,"id","play-white"),a(f,"aria-checked","true"),a(c,"for","play-white"),a(c,"class","svelte-f2deec"),a(d,"id","submit"),a(d,"type","submit"),a(d,"class","svelte-f2deec"),a(e,"id","player-options"),a(e,"class","svelte-f2deec")},m(q,h){I(q,e,h),b(e,n),b(e,s),b(e,r),b(r,l),b(r,o),b(r,i),et(r,t[1],!0),b(e,u),b(e,c),b(c,f),f.checked=t[2],b(c,w),b(e,p),b(e,d),b(e,y),m&&m.m(e,null),_||(v=[C(r,"change",t[4]),C(f,"change",t[5]),C(e,"submit",wt(t[3]))],_=!0)},p(q,[h]){h&2&&et(r,q[1]),h&4&&(f.checked=q[2]),q[1]==="cvc"?m?m.p(q,h):(m=_t(q),m.c(),m.m(e,null)):m&&(m.d(1),m=null)},i:M,o:M,d(q){q&&T(e),m&&m.d(),_=!1,z(v)}}}function Qn(t,e,n){let s=Re,r=Ke!==void 0?Ke:!0,l=100;function o(){an(s),He(void 0,r)}function i(){s=Dt(this),n(1,s)}function u(){r=this.checked,n(2,r)}function c(){l=$t(this.value),n(0,l)}return t.$$.update=()=>{t.$$.dirty&1&&Ct.set(l)},[l,s,r,o,i,u,c]}class Yn extends U{constructor(e){super(),x(this,e,Qn,Ln,A,{})}}function Xn(t){let e,n=t[0].reason.toUpperCase()+"",s,r,l,o,i;return{c(){e=V("div"),s=pe(n),r=pe(`!\r
      `),l=V("button"),l.textContent="reset",a(e,"id","checkmate"),a(e,"class","svelte-rex4nr")},m(u,c){I(u,e,c),b(e,s),b(e,r),b(e,l),o||(i=C(l,"click",t[2]),o=!0)},p(u,c){c&1&&n!==(n=u[0].reason.toUpperCase()+"")&&vt(s,n)},i:M,o:M,d(u){u&&T(e),o=!1,i()}}}function xn(t){let e,n;return e=new Yn({}),{c(){H(e.$$.fragment)},m(s,r){Q(e,s,r),n=!0},p:M,i(s){n||(P(e.$$.fragment,s),n=!0)},o(s){N(e.$$.fragment,s),n=!1},d(s){Y(e,s)}}}function Un(t){let e,n,s,r,l,o,i,u;n=new Dn({});const c=[xn,Xn],f=[];function w(p,d){return p[0].state==="play"?0:1}return r=w(t),l=f[r]=c[r](t),{c(){e=V("main"),H(n.$$.fragment),s=G(),l.c(),a(e,"id","main"),a(e,"class","svelte-rex4nr")},m(p,d){I(p,e,d),Q(n,e,null),b(e,s),f[r].m(e,null),o=!0,i||(u=C(window,"contextmenu",wt(t[1])),i=!0)},p(p,[d]){let y=r;r=w(p),r===y?f[r].p(p,d):(Me(),N(f[y],1,1,()=>{f[y]=null}),Ie(),l=f[r],l?l.p(p,d):(l=f[r]=c[r](p),l.c()),P(l,1),l.m(e,null))},i(p){o||(P(n.$$.fragment,p),P(l),o=!0)},o(p){N(n.$$.fragment,p),N(l),o=!1},d(p){p&&T(e),Y(n),f[r].d(),i=!1,u()}}}function Gn(t,e,n){let s;O(t,Vt,o=>n(0,s=o));function r(o){Xt.call(this,t,o)}return[s,r,()=>He()]}class Hn extends U{constructor(e){super(),x(this,e,Gn,Un,A,{})}}new Hn({target:document.getElementById("app")});
